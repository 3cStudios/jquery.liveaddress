(function(a,b,c){function j(){function n(){if(h.ui){a("head").prepend(m);var b=d.getMappedAddresses();for(var c=0;c<b.length;c++){var e=b[c].id();a("body").append('<div title="Loading..." class="smarty-dots smarty-addr-'+e+'"></div>');a("body").append('<div class="smarty-container smarty-address-verified smarty-addr-'+e+'"><span title="Address verified!">&#10003;</span><a href="javascript:" class="smarty-undo" title="Your address was verified. Click to undo." data-addressid="'+e+'">Verified</a></div>')}a("body").delegate(".smarty-undo","click",function(b){var c=a(this).data("addressid");var e=d.getMappedAddressByID(c);e.undo(true);a(this).hide()});a("body").delegate(".smarty-address-verified","mouseover",function(b){a(".smarty-undo",this).text("Undo?")});a("body").delegate(".smarty-address-verified","mouseout",function(b){a(".smarty-undo",this).text("Verified")})}for(var c=0;c<i.length;c++){var f=i[c];var g=function(a){if(a.data.form&&a.data.form.processing)return u(a);for(var b=0;b<a.data.form.addresses.length;b++)a.data.form.addresses[b].syncWithDom();if(!a.data.form.allAddressesAccepted()){var c=a.data.form.addressesNotAccepted();if(c.length>0)s("VerificationInvoked",{address:c[0],invoke:a.data.invoke});return u(a)}};var j=a(h.submitSelector,f.dom);j.each(function(b){var c;if(a(this).data("events")&&a(this).data("events").click&&a(this).data("events").click.length>0){c=a.extend(true,[],a(this).data("events").click)}a(this).unbind("click");a(this).click({form:f,invoke:this},g);if(typeof this.onclick==="function"){var d=this.onclick;this.onclick=null;a(this).click(d)}if(c)for(var e=0;e<c.length;e++)a(this).click(c[e].data,c[e].handler)})}}function o(b,c,d){var e=r(b.name);var f=r(b.id);var g=r(b.placeholder);var h=r(b.title);for(var i=0;i<c.length;i++)if(e.indexOf(c[i])>-1||f.indexOf(c[i])>-1)return true;if(!("labels"in b)){var j=a("label[for="+f+"]")[0]||a(b).parents("label")[0];b.labels=!j?[]:[j]}for(var i=0;i<b.labels.length;i++){for(var k=0;k<d.length;k++)if(b.labels[i].innerText.toLowerCase().indexOf(d[k])>-1)return true}for(var i=0;i<d.length;i++)if(g.indexOf(d[i])>-1||h.indexOf(d[i])>-1)return true;return false}function p(b,d){a(c).unbind("keyup");a(b).slideUp(g.speed,function(){a(this).remove();a(this).unbind("click")});s("Completed",d.data)}function q(b){for(var c in b)a("body").undelegate(b[c],"click")}var e={formDataProperty:"smarty-form",identifiers:{streets:{names:["street","address","address1","address2","addr1","addr2","address-1","address-2","address_1","address_2","line","suite","apartment","primary","secondary"],labels:["street","address","line "," line","suite","apartment","apt:","apt.","ste:","ste.","unit:","unit.","unit ","primary","secondary"]},city:{names:["city","town","village","cityname","city-name","city_name"],labels:["city","town","city name"]},state:{names:["state","province","region","section","territory"],labels:["state","province","region","section","territory"]},zipcode:{names:["zip","zipcode","zip-code","zip_code","postal_code","postal-code","postalcode","postcode","post-code","post_code","postal","zcode"],labels:["zip","zip code","postal code","postcode","locality"]},country:{names:["country","nation","sovereignty"],labels:["country","nation","sovereignty"]}},street1exacts:{names:["address","street","streetaddress","street-address","street_address","streetaddr","street-addr","street_addr","str","str1","street1","addr"]},street2:{names:["address2","street2","addr2","line2","str2","second","two","box"],labels:[" 2","second","two","ste","apt","unit","box"]},exclude:{names:["email","e-mail","e_mail","firstname","first-name","first_name","lastname","last-name","last_name","fname","lname","name","eml","type","method","location","store","save","keep","phn","phone","cardholder","security","comp","firm","org","group","gate","cvc","cvv"],labels:["email","e-mail","e mail"," type","save ","keep","name","method","phone","organization","company","addressee","firm","group","gate","cardholder","cvc","cvv"]}};var f=24,j=8;var m="<style>"+".smarty-dots { display: none; position: absolute; z-index: 999; width: "+f+"px; height: "+j+"px; background-image: url('data:image/gif;base64,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'); }"+".smarty-address-verified { display: none; position: absolute; z-index: 999; width: 55px; border: 1px solid #80AA00; padding: 1px; font-size: 16px; font-family: sans-serif; color: #2D8D0D; line-height: 1.25em; background: #E2FFBE; border-radius: 10px 3px 3px 10px; padding-left: 3px; }"+".smarty-undo { font-size: 11px; padding: 4px; color: #537700; vertical-align: top; text-decoration: none; } .smarty-undo:hover { color: #CC0000; }"+".smarty-address-ambiguous, .smarty-address-invalid { font-size: 14px; font-family: sans-serif; text-align: left; line-height: 1em !important; color: black; background: #EEE; padding: 10px; border-radius: 5px; z-index: 999; box-shadow: 0px 10px 35px rgba(0, 0, 0, .7); }"+".smarty-address-ambiguous a, .smarty-address-invalid a { color: #0055D4; font-weight: normal; } .smarty-address-ambiguous a:hover, .smarty-address-invalid a:hover { color: #119FF2 }"+".smarty-ambiguous-message, .smarty-invalid-message { font-family: 'Helvetica Neue', sans-serif; font-weight: 300; padding: 10px 0 25px; font-size: 18px; border-bottom: 1px solid #888; text-align: center; }"+".smarty-address-ambiguous { border: 1px solid #AAA; border-top: 10px solid #AAA; }"+".smarty-ambiguous-message { color: #000; }"+".smarty-address-invalid { border: 1px solid #CC0000; border-top: 10px solid #CC0000; }"+".smarty-invalid-message { color: #000; }"+"a.smarty-choice { font-size: 14px !important; padding: 17px !important; text-decoration: none !important; display: block !important; background: #F5F5F5; color: #222; border-bottom: 1px solid #CCC; }"+".smarty-address-ambiguous .smarty-choice:hover, .smarty-address-ambiguous .smarty-choice:hover * { background: #444; color: #FFF; }"+".smarty-address-invalid .smarty-choice { background: #F5F5F5; color: #60AD08; }"+".smarty-address-invalid .smarty-choice:hover { background: #A3C952; color: #FFF; }"+".smarty-address-invalid a:hover { color: #CC0000; }"+".smarty-address-ambiguous a.smarty-use-original { font-size: 12px !important; padding: 7px 17px !important; }"+".smarty-address-invalid a.smarty-use-original { color: #CC0000 !important; }"+"a.smarty-use-original:hover { color: #FFF !important; background: #CC0000 !important; }"+"a.smarty-abort { position: absolute !important; top: 5px !important; right: 5px; background: #DDD; color: #999; border-radius: 10px; padding: 2px 6px; font-size: 10px !important; text-decoration: none !important; }"+"a.smarty-choice-abort { padding: 7px 17px !important; } a.smarty-choice-abort:hover { background: #A3C952 !important; color #FFF !important; }";this.clean=function(){if(i.length==0)return;if(h.debug)console.log("Cleaning up old form map data...");for(var b=0;b<i.length;b++){a(i[b].dom).data(e.formDataProperty,"");for(var c=0;c<i[b].addresses.length;c++){var d=i[b].addresses[c].getDomFields();for(var f in d){if(h.debug)a(d[f]).css("background","none").attr("placeholder","");a(d[f]).unbind("change")}}}a(".smarty-dots, .smarty-address-verified").remove();a("body").undelegate(".smarty-undo","click");i=[];if(h.debug)console.log("Done cleaning up form map data; ready for new mapping.")};this.automap=function(b){if(h.debug)console.log("Automapping fields...");this.clean();a("form").each(function(c){var d=new l(this);var f={};for(var g in e.identifiers){var j=e.identifiers[g].names;var m=e.identifiers[g].labels;f[g]=a(h.fieldSelector,this).filter(function(){return a(this).closest(b).length>0}).filter(":visible").filter(function(){var a=r(this.name),b=r(this.id);if(g=="streets"){for(var c=0;c<e.street1exacts.names.length;c++)if(a==e.street1exacts.names[c]||b==e.street1exacts.names[c])return true}var d=o(this,j,m);if(g=="streets"){var f=["city","state","zipcode","country"];for(var c=0;c<f.length;c++){if(o(this,e.identifiers[f[c]].names,e.identifiers[f[c]].labels))return false}}return d}).not(function(){var a=r(this.name),b=r(this.id);if(a=="name"||b=="name")return true;return o(this,e.exclude.names,e.exclude.labels)}).toArray()}f.street=[],f.street2=[];if(f.streets.length<=f.city.length*1.5||f.streets.length<=f.zipcode.length*1.5){f.street=f.streets}else{for(var n=0;n<f.streets.length;n++){var p=f.streets[n];if(o(p,e.street2.names,e.street2.labels)||n>0&&p.name==f.streets[n-1].name){f.street2.push(p)}else f.street.push(p)}}delete f.streets;if(h.debug)console.log("For form "+c+", the initial scan found these fields:",f);var q=Math.max(f.street.length,f.street2.length);if(h.debug&&q==0)console.log("No addresses were found in form "+c+".");for(var n=0;n<q;n++){var s={};for(var t in f){var p=f[t][n];if(p)s[t]=p}var u=s.zipcode||s.state&&s.city;var v=s.city||s.state||s.zipcode;if(!s.street&&u||s.street&&!u&&v){if(h.debug)console.log("Form "+c+" contains some address input elements, but not enough for a complete address.");continue}d.addresses.push(new k(s,d))}i.push(d);if(h.debug)console.log("Form "+c+" is finished:",d)});n();if(h.debug)console.log("Automapping complete.");s("FieldsMapped")};this.mapFields=function(b,c){if(h.debug)console.log("Manually mapping fields given this data:",b);this.clean();var d=[];for(var f in b){var g=b[f];if(!g.street)continue;for(var j in g)g[j]=a(g[j],c);var m=a(g.street).parents("form")[0];var o=new l(m);if(!a(m).data(e.formDataProperty)){a(m).data(e.formDataProperty,1);d.push(o)}else{for(var p=0;p<d.length;p++){if(d[p].dom==m){o=d[p];break}}}o.addresses.push(new k(g,o))}i=d;n();s("FieldsMapped")};this.disableFields=function(b){if(!h.ui)return;var c=b.getDomFields();for(var d in c){a(c[d]).attr("disabled","disabled")}a(h.submitSelector,b.form.dom).attr("disabled","disabled")};this.enableFields=function(b){if(!h.ui)return;var c=b.getDomFields();for(var d in c)a(c[d]).removeAttr("disabled");a(h.submitSelector,b.form.dom).removeAttr("disabled")};this.showLoader=function(b){if(!h.ui)return;var c=b.corners(true);var d=a(".smarty-dots.smarty-addr-"+b.id());d.css("top",c.top+c.height/2-j/2+"px").css("left",c.right-f-3+"px");a(".smarty-dots.smarty-addr-"+b.id()).show()};this.hideLoader=function(b){if(h.ui)a(".smarty-dots.smarty-addr-"+b.id()).hide()};this.showValid=function(b){if(!h.ui)return;var c=a(".smarty-address-verified.smarty-addr-"+b.id());var d=b.corners(true);c.css("top",d.top+d.height/2-12+"px").css("left",d.right-3+"px");if(c.length>0&&!c.is(":visible"))c.show(g.speed)};this.hideValid=function(b){var c=".smarty-address-verified.smarty-addr-"+b.id();if(!b||!h.ui||!a(c).is(":visible"))return;a(c).hide(g.speed,function(){a(".smarty-undo",this).show()})};this.showAmbiguous=function(d){if(!h.ui)return;var e=d.address;var f=d.response;var i=e.corners();i.width=Math.max(i.width,380);i.height=Math.max(i.height,f.length*48+145);var j='<div class="smarty-container smarty-address-ambiguous smarty-addr-'+e.id()+'" style="position: absolute; '+"top: "+i.top+"px; left: "+i.left+"px; width: "+i.width+"px; height: "+i.height+'px;">'+'<a href="javascript:" class="smarty-abort">x</a>'+'<div class="smarty-ambiguous-message">'+h.ambiguousMessage+"</div>";for(var k=0;k<f.raw.length;k++){var l=f.raw[k].delivery_line_1,m=f.raw[k].components.city_name,n=f.raw[k].components.state_abbreviation,o=f.raw[k].components.zipcode+"-"+f.raw[k].components.plus4_code;j+='<a href="javascript:" class="smarty-choice smarty-good-addr" data-index="'+k+'"><b>'+l+"</b>  "+m+", "+n+" "+o+"</a>"}j+='<a href="javascript:" class="smarty-choice smarty-choice-abort">None of these; I\'ll type another address</a>';j+='<a href="javascript:" class="smarty-choice smarty-use-original">I certify what I typed is correct<br>('+e.toString()+")</a></div>";a(j).hide().appendTo("body").show(g.speed);if(a(c).scrollTop()>i.top-100||a(c).scrollTop()<i.top-a(b).height()+100){a("html, body").stop().animate({scrollTop:a(".smarty-address-ambiguous").offset().top-100},500)}d.selectors={goodAddr:".smarty-address-ambiguous.smarty-addr-"+e.id()+" .smarty-good-addr",useOriginal:".smarty-address-ambiguous .smarty-use-original",abort:".smarty-address-ambiguous.smarty-addr-"+e.id()+" .smarty-abort, .smarty-address-ambiguous.smarty-addr-"+e.id()+" .smarty-choice-abort"};a("body").delegate(d.selectors.goodAddr,"click",d,function(b){a(".smarty-addr-"+e.id()+".smarty-address-ambiguous").slideUp(g.speed,function(){a(this).remove()});q(b.data.selectors);delete b.data.selectors;s("UsedSuggestedAddress",{address:b.data.address,response:b.data.response,invoke:b.data.invoke,chosenCandidate:f.raw[a(this).data("index")]})});a("body").delegate(d.selectors.useOriginal,"click",d,function(b){a(".smarty-addr-"+b.data.address.id()+".smarty-address-ambiguous").slideUp(g.speed,function(){a(this).remove()});q(b.data.selectors);delete b.data.selectors;s("OriginalInputSelected",b.data)});a(c).keyup(d,function(a){if(a.keyCode==27){q(a.data.selectors);delete a.data.selectors;p(".smarty-addr-"+a.data.address.id()+".smarty-address-ambiguous",a)}});a(d.selectors.abort).click(d,function(b){q(b.data.selectors);delete b.data.selectors;p(a(this).parents(".smarty-address-ambiguous")[0],b)})};this.showInvalid=function(d){if(!h.ui)return;var e=d.address;var f=d.response;var i=e.corners();i.width=Math.max(i.width,350);i.height=Math.max(i.height,175);var j='<div class="smarty-container smarty-address-invalid smarty-addr-'+e.id()+'" style="position: absolute; '+"top: "+i.top+"px; left: "+i.left+"px; width: "+i.width+"px; height: "+i.height+'px;">'+'<a href="javascript:" class="smarty-abort">x</a>'+'<div class="smarty-invalid-message">'+h.invalidMessage+"</div>"+'<a href="javascript:" class="smarty-choice smarty-invalid-rejectoriginal">› I will double-check the address</a>'+'<a href="javascript:" class="smarty-choice smarty-use-original">› I certify what I typed is correct<br>   ('+e.toString()+")</a></div>";a(j).hide().appendTo("body").show(g.speed);d.selectors={rejectOriginal:".smarty-address-invalid .smarty-invalid-rejectoriginal",useOriginal:".smarty-address-invalid .smarty-use-original",abort:".smarty-address-invalid.smarty-addr-"+e.id()+" .smarty-abort"};if(a(c).scrollTop()>i.top-100||a(c).scrollTop()<i.top-a(b).height()+100){a("html, body").stop().animate({scrollTop:a(".smarty-address-invalid").offset().top-100},500)}a("body").delegate(d.selectors.rejectOriginal,"click",d,function(b){a(".smarty-addr-"+b.data.address.id()+".smarty-address-invalid").slideUp(g.speed,function(){a(this).remove()});a(c).unbind("keyup");q(b.data.selectors);delete b.data.selectors;s("InvalidAddressRejected",b.data)});a("body").delegate(d.selectors.useOriginal,"click",d,function(b){a(".smarty-addr-"+e.id()+".smarty-address-invalid").slideUp(g.speed,function(){a(this).remove()});a(c).unbind("keyup");q(b.data.selectors);delete b.data.selectors;s("OriginalInputSelected",b.data)});a(c).keyup(d,function(a){if(a.keyCode==27){q(a.data.selectors);p(".smarty-addr-"+a.data.address.id()+".smarty-address-invalid",a)}});a(d.selectors.abort).click(d,function(b){q(b.data.selectors);p(a(this).parents(".smarty-address-invalid")[0],b)})}}function k(b,c){var d=this;var f;var i;var j="accepted";var k=["street","street2","secondary","city","state","zipcode","lastline","addressee","urbanization","country"];var l=function(b,c,g,h,i,j){if(!p(k,b))return false;if(!f[b])f[b]={};var l=f[b].value!=c;f[b].undo=f[b].value||"";f[b].value=c;if(g&&f[b].dom)a(f[b].dom).val(c);var m={sourceEvent:i,field:b,address:d,value:c,suppressAutoVerification:j||false};if(l&&!h){e.hideValid(d);if(d.isDomestic()){d.unaccept();s("AddressChanged",m)}else d.accept({address:d},false)}return true};this.form=c;this.verifyCount=0;this.lastField;this.load=function(b){f={};i=q(1,99999);if(typeof b==="object"){this.lastField=b.lastline||b.zipcode||b.state||b.city||b.street;var c=true;for(var d in b){if(!p(k,d))continue;var e=a(b[d]);var g=e.toArray().length==0;var l;if(e.toArray().length==0)l=b[d];else l=e.val();f[d]={};f[d].value=l;f[d].undo=l;c=c?l.length==0||b[d].tagName=="SELECT":c;if(!g){if(h.debug){e.css("background","#FFFFCC");e.attr("placeholder",d)}f[d].dom=b[d]}var m={address:this,field:d,value:l};a(b[d]).change(m,function(a){a.data.address.set(a.data.field,a.target.value,false,false,a,false)})}if(!c)j="changed"}};this.load(b);this.set=function(a,b,c,d,e,f){if(typeof a==="string"&&arguments.length>=2)return l(a,b,c,d,e,f);else if(typeof a==="object"){var g=true;for(var h in a)g=l(h,a[h],c,d,e,f)?g:false;return g}};this.replaceWith=function(a,b,c){if(typeof a==="array"&&a.length>0)a=a[0];if(d.isFreeform()){var e=(a.addressee?a.addressee+" ":"")+(a.delivery_line_1?a.delivery_line_1+" ":"")+(a.delivery_line_2?a.delivery_line_2+" ":"")+(a.components.urbanization?a.components.urbanization+" ":"")+(a.last_line?a.last_line:"");d.set("street",e,b,true,c,false)}else{if(a.addressee)d.set("addressee",a.addressee,b,true,c,false);if(a.delivery_line_1)d.set("street",a.delivery_line_1,b,true,c,false);d.set("street2",a.delivery_line_2||"",b,true,c,false);d.set("secondary","",b,true,c,false);if(a.components.urbanization)d.set("urbanization",a.components.urbanization,b,true,c,false);if(a.components.city_name)d.set("city",a.components.city_name,b,true,c,false);if(a.components.state_abbreviation)d.set("state",a.components.state_abbreviation,b,true,c,false);if(a.components.zipcode&&a.components.plus4_code)d.set("zipcode",a.components.zipcode+"-"+a.components.plus4_code,b,true,c,false)}};this.corners=function(b){var c={};if(!b){for(var e in f){if(!f[e].dom)continue;var g=f[e].dom;var h=a(g).offset();h.right=h.left+a(g).outerWidth();h.bottom=h.top+a(g).outerHeight();c.top=!c.top?h.top:Math.min(c.top,h.top);c.left=!c.left?h.left:Math.min(c.left,h.left);c.right=!c.right?h.right:Math.max(c.right,h.right);c.bottom=!c.bottom?h.bottom:Math.max(c.bottom,h.bottom)}}else{var i=a(d.lastField);c=i.offset();c.right=c.left+i.outerWidth();c.bottom=c.top+i.outerHeight()}c.width=c.right-c.left;c.height=c.bottom-c.top;return c};this.verify=function(b){if(!b&&!d.enoughInput())return null;e.disableFields(d);d.verifyCount++;var c=d.toRequest();a.ajax({url:g.requestUrl+"?auth-token="+h.key+"&callback=?",dataType:"jsonp",data:c,timeout:h.timeout}).done(function(a,c,e){s("ResponseReceived",{address:d,response:new m(a),invoke:b})}).fail(function(a,c){s("RequestTimedOut",{address:d,status:c,invoke:b});d.verifyCount--});s("RequestSubmitted",{address:d})};this.enoughInput=function(){return f.street&&f.street.value&&(f.city&&f.city.value&&f.state&&f.state.value||f.zipcode&&f.zipcode.value||!f.street2&&!f.city&&!f.state&&!f.zipcode)};this.toRequest=function(){var b={};for(var c in f){var d={};d[c]=f[c].value.replace(/\r|\n/g," ");a.extend(b,d)}return a.extend(b,{candidates:h.candidates})};this.toString=function(){return(f.street?f.street.value+" ":"")+(f.street2?f.street2.value+" ":"")+(f.secondary?f.secondary.value+" ":"")+(f.city?f.city.value+" ":"")+(f.state?f.state.value+" ":"")+(f.zipcode?f.zipcode.value:"")};this.abort=function(a,b){b=typeof keepAccet==="undefined"?false:b;if(!b)d.unaccept();delete d.form.processing;return u(a)};this.isFreeform=function(){return f.street&&!f.street2&&!f.secondary&&!f.addressee&&!f.city&&!f.state&&!f.zipcode&&!f.urbanization&&!f.lastline};this.get=function(a){return f[a]?f[a].value:null};this.undo=function(a){a=typeof a==="undefined"?true:a;for(var b in f)this.set(b,f[b].undo,a,false,undefined,true)};this.accept=function(a,b){b=typeof b==="undefined"?true:b;j="accepted";e.enableFields(d);if(b)e.showValid(d);s("AddressAccepted",a)};this.unaccept=function(){j="changed";e.hideValid(d)};this.getUndoValue=function(a){return f[a].undo};this.status=function(){return j};this.syncWithDom=function(b){for(var c in f){if(!f[c].dom&&f[c].value&&!b){delete f[c];continue}else if(f[c].dom&&f[c].value){var e=a(f[c].dom).val();if(f[c].value!=e){d.unaccept();f[c].value=e}}}};this.getDomFields=function(){var b={};for(var c in f){var d={};d[c]=f[c].dom;a.extend(b,d)}return b};this.hasDomFields=function(){for(var a in f)if(f[a].dom)return true};this.isDomestic=function(){if(!f.country)return true;var a=f.country.value.toUpperCase().replace(/\.|\s|\(|\)|\\|\/|-/g,"");var b=["","0","COUNTRY","NONE","US","USA","USOFA","USOFAMERICA","AMERICAN","UNITEDSTATES","UNITEDSTATESAMERICA","UNITEDSTATESOFAMERICA","AMERICA","840","223","AMERICAUNITEDSTATES","AMERICAUS","AMERICAUSA"];return p(b,a)||f.country.value=="-1"};this.id=function(){return i}}function l(a){this.addresses=[];this.dom=a;this.allAddressesAccepted=function(){for(var a=0;a<this.addresses.length;a++){var b=this.addresses[a];if(b.status()!="accepted")return false}return true};this.addressesNotAccepted=function(){var a=[];for(var b=0;b<this.addresses.length;b++){var c=this.addresses[b];if(c.status()!="accepted")a.push(c)}return a}}function m(a){var b=function(b){if(b>=a.length||b<0){if(a.length==0)throw new Error("Candidate index is out of bounds (no candidates returned; requested "+b+")");else throw new Error("Candidate index is out of bounds ("+a.length+" candidates; indicies 0 through "+(a.length-1)+" available; requested "+b+")")}};var c=function(a){return typeof a==="undefined"?0:a};this.raw=a;this.length=a.length;this.numCandidates=function(){return a.length};this.isValid=function(){return this.length==1};this.isInvalid=function(){return this.length==0};this.isAmbiguous=function(){return this.length>1};this.isMissingSecondary=function(a){a=c(a);b(a);return this.raw[a].analysis.dpv_footnotes.indexOf("N1")>-1||this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("H#")>-1};this.isBadSecondary=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("S#")>-1};this.componentChanged=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("L#")>-1};this.betterAddressExists=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("P#")>-1};this.isExactMatch=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.dpv_footnotes=="AABB"};this.isUniqueZipCode=function(a){a=c(a);b(a);return this.raw[a].analysis.dpv_footnotes.indexOf("U1")>-1||this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("Q#")>-1};this.fixedAbbreviations=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("N#")>-1};this.fixedZipCode=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("A#")>-1};this.fixedSpelling=function(a){a=c(a);b(a);return this.raw[a].analysis.footnotes.indexOf("B#")>-1||this.raw[a].analysis.footnotes&&this.raw[a].analysis.footnotes.indexOf("M#")>-1};this.isBuildingDefault=function(a){a=c(a);b(a);return this.raw[a].metadata.building_default_indicator};this.isMilitary=function(a){a=c(a);b(a);return this.raw[a].analysis.dpv_footnotes.indexOf("F1")>-1};this.hasExtraSecondary=function(a){a=c(a);b(a);return this.raw[a].analysis.dpv_footnotes.indexOf("CC")>-1};this.isLacsLink=function(a){a=c(a);b(a);return this.raw[a].analysis.lacslink_code=="A"}}function n(a,b){var c=o[a.type];if(c)c(a,b)}function p(a,b){for(var c in a)if(a[c]===b)return true;return false}function q(a,b){return Math.floor(Math.random()*(b-a+1))+a}function r(a){return a?a.toLowerCase().replace("[]",""):""}function s(b,d){a(c).triggerHandler(b,d)}function t(b){a(c).bind(b,n)}function u(a){if(!a)return false;if(a.preventDefault)a.preventDefault();if(a.stopPropagation)a.stopPropagation();if(a.stopImmediatePropagation)a.stopImmediatePropagation();a.cancelBubble=true;return false}"use strict";var d;var e=new j;var f="2.0.1";var g={candidates:3,requestUrl:"https://api.qualifiedaddress.com/street-address",timeout:5e3,speed:"medium",ambiguousMessage:"Please choose the most correct address.",invalidMessage:"Address could not be verified.",fieldSelector:"input[type=text], input[type=], textarea, select",submitSelector:"[type=submit], [type=image], input[type=button]:last"};var h={};var i=[];a.LiveAddress=function(b){return a("body").LiveAddress(b)};a.fn.LiveAddress=function(b){if(d)return d;var c=this.selector;var j=a.fn.jquery.split(".");if(j.length>=2){if(j[0]<1||j[0]>=1&&j[1]<5){console.log("jQuery version "+a.fn.jquery+" found, but LiveAddress requires jQuery version 1.5 or higher. Aborting.");return false}}if(b.debug)console.log("LiveAddress API jQuery Plugin version "+f+" (Debug mode)");if(typeof b==="string"){h={key:b,candidates:g.candidates}}else if(typeof b==="object"){h=a.extend(h,b)}h.candidates=h.candidates||g.candidates;h.ui=typeof h.ui==="undefined"?true:h.ui;h.autoMap=typeof h.autoMap==="undefined"?true:h.autoMap;h.autoVerify=typeof h.autoVerify==="undefined"?true:h.autoVerify;h.timeout=h.timeout||g.timeout;h.ambiguousMessage=h.ambiguousMessage||g.ambiguousMessage;h.invalidMessage=h.invalidMessage||g.invalidMessage;h.fieldSelector=h.fieldSelector||g.fieldSelector;h.submitSelector=h.submitSelector||g.submitSelector;if(h.candidates<1)h.candidates=1;else if(h.candidates>10)h.candidates=10;d={events:o,on:function(a,b){if(!o[a]||typeof b!=="function")return false;var c=o[a];o[a]=function(a,d){b(a,d,c)}},mapFields:function(a){if(typeof a==="object")return e.mapFields(a,c);else if(a==="auto")return e.automap(c);else if(typeof h.addresses==="object")return e.mapFields(h.addresses,c);else if(h.autoMap)return e.automap(c);else return false},makeAddress:function(a){if(typeof a==="string")return new k({street:a});else if(typeof a==="object")return new k(a)},verify:function(a,b){var c=d.makeAddress(a);c.verify(b)},getMappedAddresses:function(){var a=[];for(var b=0;b<i.length;b++)for(var c=0;c<i[b].addresses.length;c++)a.push(i[b].addresses[c]);return a},getMappedAddressByID:function(a){for(var b=0;b<i.length;b++)for(var c=0;c<i[b].addresses.length;c++)if(i[b].addresses[c].id()==a)return i[b].addresses[c]},setKey:function(a){h.key=a},version:f};for(var l in o)t(l);a(function(){if(h.autoMap)d.mapFields(c)});return d};var o={FieldsMapped:function(a,b){if(h.debug)console.log("EVENT:","FieldsMapped","(Field mapping completed)",a,b)},AddressChanged:function(a,b){if(h.debug)console.log("EVENT:","AddressChanged","(Address changed)",a,b);if(h.autoVerify&&b.address.enoughInput()&&(b.address.verifyCount==0||b.address.isFreeform())&&!b.suppressAutoVerification&&b.address.hasDomFields())s("VerificationInvoked",{address:b.address})},VerificationInvoked:function(a,b){if(h.debug)console.log("EVENT:","VerificationInvoked","(Verification invoked)",a,b);if(b.address.form)b.address.form.processing=true;b.address.verify(b.invoke)},RequestSubmitted:function(a,b){if(h.debug)console.log("EVENT:","RequestSubmitted","(Request submitted)",a,b);e.showLoader(b.address)},ResponseReceived:function(a,b){if(h.debug)console.log("EVENT:","ResponseReceived","(Response received)",a,b);e.hideLoader(b.address);if(typeof b.invoke==="function")b.invoke(b.response);else{if(b.response.isInvalid())s("AddressWasInvalid",b);else if(b.response.isValid())s("AddressWasValid",b);else s("AddressWasAmbiguous",b)}},RequestTimedOut:function(b,c){if(h.debug)console.log("EVENT:","RequestTimedOut","(Request timed out)",b,c);if(c.address.form)delete c.address.form.processing;if(c.invoke){c.address.accept(c,false);if(typeof c.invoke!=="function")a(c.invoke).click();else c.invoke(c)}e.enableFields(c.address);e.hideLoader(c.address)},AddressWasValid:function(a,b){if(h.debug)console.log("EVENT:","AddressWasValid","(Response indicates input address was valid)",a,b);var c=b.address;var d=b.response;c.replaceWith(d.raw[0],true,a);c.accept(b)},AddressWasAmbiguous:function(a,b){if(h.debug)console.log("EVENT:","AddressWasAmbiguous","(Response indiciates input address was ambiguous)",a,b);e.showAmbiguous(b)},AddressWasInvalid:function(a,b){if(h.debug)console.log("EVENT:","AddressWasInvalid","(Response indicates input address was invalid)",a,b);e.showInvalid(b)},OriginalInputSelected:function(a,b){if(h.debug)console.log("EVENT:","OriginalInputSelected","(User chose to use original input)",a,b);b.address.accept(b,false)},UsedSuggestedAddress:function(a,b){if(h.debug)console.log("EVENT:","UsedSuggestedAddress","(User chose to a suggested address)",a,b);b.address.replaceWith(b.chosenCandidate,true,a);b.address.accept(b)},InvalidAddressRejected:function(a,b){if(h.debug)console.log("EVENT:","InvalidAddressRejected","(User chose to correct an invalid address)",a,b);if(b.address.form)delete b.address.form.processing;s("Completed",b)},AddressAccepted:function(b,c){if(h.debug)console.log("EVENT:","AddressAccepted","(Address marked accepted)",b,c);if(c.address.form)delete c.address.form.processing;if(c.invoke&&typeof c.invoke!=="function")a(c.invoke)[0].click();s("Completed",c)},Completed:function(a,b){if(h.debug)console.log("EVENT:","Completed","(All done)",a,b);if(b.address){e.enableFields(b.address);if(b.address.form)delete b.address.form.processing}}}})(jQuery,window,document)